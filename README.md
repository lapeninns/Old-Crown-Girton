# External JSON Content Loader

This project now supports runtime-loaded JSON content so updates can be deployed by publishing new JSON to a CDN (no app redeploy required).

## How it works

1. Components call `useData('site.json')` (or another file name).
2. The loader resolves a base URL at runtime: `process.env.NEXT_PUBLIC_DATA_BASE_URL` (if set) else `/data`.
3. It fetches `BASE/site.json` with `cache: 'no-store'` and keeps a per-session in‑memory promise cache.
4. Dev fallback JSON lives at `public/data/site.json`.

## Environment Variable

Create `.env.local`:

```
NEXT_PUBLIC_DATA_BASE_URL=https://your-cdn.example.com/app-data
```

If omitted, the loader falls back to `/data` (served from `public/data`).

## Adding New Content Files

1. Publish a JSON file to your data base URL, e.g. `features.json`.
2. Add types in `types/content.ts` if needed.
3. Use the hook: `const { data } = useData<FeatureData>('features.json');`

## Types

Defined in `types/content.ts`:

```ts
export type Project = { id: string; title: string; description: string; tags: string[]; url?: string };
export type SiteData = { version: number; projects: Project[] };
```

## Error & Loading States

The hook returns `{ data, error, loading }`. Show skeletons while loading and a friendly message on errors.

## Updating Content

1. Edit JSON at the CDN (or locally under `public/data`).
2. Refresh the page – new data renders immediately (no build needed).

## Optional Validation

Install `zod` and create a schema wrapper similar to:

```ts
import { z } from 'zod';
export const SiteDataSchema = z.object({ version: z.number(), projects: z.array(z.object({ id: z.string(), title: z.string(), description: z.string(), tags: z.array(z.string()), url: z.string().url().optional() })) });
```

Then build a `useParsedData` hook that uses `safeParse` and displays an error if validation fails.

## Acceptance Checklist

- With `NEXT_PUBLIC_DATA_BASE_URL` set, network request targets that base.
- Without it, it requests `/data/site.json`.
- Changing JSON, then refresh => new content appears.
- Errors show user-friendly message.
- TypeScript compiles with added types.

## Testing

Set env and run `npm run dev`, visit `/projects`. Unset env (or change) and observe network request path in browser devtools.

---

Generated by automated refactor.
